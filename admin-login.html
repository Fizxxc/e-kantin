<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Login â€” E-Kantin</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.lordicon.com/lusqsztk.js"></script>

  <style>
    body { background: linear-gradient(135deg,#ff6a88,#ffc371); }
    .glass { background: rgba(255,255,255,0.08); backdrop-filter: blur(6px); border: 1px solid rgba(255,255,255,0.08); }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-6">

  <main class="w-full max-w-md glass rounded-3xl p-8 shadow-2xl text-white">
    <div class="flex justify-center mb-4">
      <lord-icon src="https://cdn.lordicon.com/usbxdsir.json" trigger="loop" style="width:96px;height:96px"></lord-icon>
    </div>

    <h1 class="text-2xl font-bold text-center mb-2">Admin Login</h1>
    <p class="text-center text-white/70 mb-6">Masuk dengan akun admin untuk mengelola kantin</p>

    <div class="space-y-4">
      <input id="admEmail" type="email" placeholder="Email admin"
        class="w-full p-3 rounded-xl bg-white/10 placeholder-white/60 outline-none border border-white/5" />

      <input id="admPassword" type="password" placeholder="Password"
        class="w-full p-3 rounded-xl bg-white/10 placeholder-white/60 outline-none border border-white/5" />

      <button id="btnAdminLogin" class="w-full py-3 rounded-xl bg-black bg-opacity-80 hover:bg-opacity-90 transition font-semibold shadow">
        Login Admin
      </button>
    </div>

    <div class="mt-5 text-center text-white/70 text-sm">
      Butuh akun admin? <a href="admin-register.html" class="text-white underline">Register Admin</a>
    </div>
  </main>

  <script type="module">
    import { loginAdmin, isAdmin } from "./js/firebase.js";

    const btn = document.getElementById("btnAdminLogin");

    btn.addEventListener("click", async () => {
      const emailVal = document.getElementById("admEmail").value.trim();
      const passVal  = document.getElementById("admPassword").value.trim();

      if(!emailVal || !passVal){
        Swal.fire({ icon: "warning", title: "Isi email & password" });
        return;
      }

      try {
        const cred = await loginAdmin(emailVal, passVal);
        const uid = cred.user.uid;

        const ok = await isAdmin(uid);
        if(!ok){
          Swal.fire({ icon: "error", title: "Akun bukan admin", text: "Akses ditolak" });
          // optional: langsung sign out if needed
          return;
        }

        Swal.fire({ icon: "success", title: "Login admin sukses", timer: 800, showConfirmButton: false })
          .then(()=> location.href = "admin-dashboard.html");
      } catch(err){
        Swal.fire({ icon: "error", title: "Login gagal", text: err.message || "Periksa kredensial" });
      }
    });
  </script>
</body>
</html>
