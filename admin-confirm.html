<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Konfirmasi Order</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body class="bg-slate-100 min-h-screen flex items-center justify-center">
<div class="bg-white p-6 rounded-xl shadow w-full max-w-lg">

<h1 class="text-xl font-bold mb-4">Konfirmasi Pesanan</h1>

<div id="detail" class="space-y-2 text-sm"></div>

<button id="confirmBtn" class="mt-6 w-full py-3 bg-indigo-600 text-white rounded-lg">
Konfirmasi & Lunas
</button>

</div>

<script type="module">
import { getOrderById, markOrderPaid } from "./js/firebase.js";

const id = new URLSearchParams(location.search).get("order");
const detail = document.getElementById("detail");

(async()=>{
  const o = await getOrderById(id);
  if(!o){
    detail.innerHTML = "<div class='text-red-500'>Order tidak ditemukan</div>";
    return;
  }

  detail.innerHTML = `
    <div><b>ID:</b> ${o.id}</div>
    <div><b>User:</b> ${o.userId}</div>
    <div><b>Total:</b> Rp ${Number(o.total).toLocaleString()}</div>
    <div><b>Status:</b> ${o.status}</div>
  `;

  document.getElementById("confirmBtn").onclick = async()=>{
    await markOrderPaid(o.id);
    Swal.fire("Sukses","Pembayaran dikonfirmasi","success")
      .then(()=>location.href="/admin-dashboard.html");
  };
})();
</script>
</body>
</html>
